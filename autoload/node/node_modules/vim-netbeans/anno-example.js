var nb = require("./");

var star = new nb.AnnotationType({
    name: "star",
    tooltip: "adsf",
    glyph: "*",
    fg: 4,
    bg: 6
});

var server = new nb.VimServer({
    debug: true
});
server.on("clientAuthed", function (vim) {
    vim.on("newBuffer", function (buffer) {
        buffer.startDocumentListen();
    });

    vim.on("insert", function (buffer, offset, text) {
        console.log("Inserted text at " + offset + ": " + text);
    });

    vim.on("remove", function (buffer, offset, length) {
        console.log("Removed " + length + " bytes at " + offset);
    });

    vim.key("C-i", function (buffer, offset, lnum, col) {
        // insert a random number before the current line
        var num = Math.round(10000 * Math.random());
        buffer.insert(offset - col, num);
    });

    vim.key("C-a", function (buffer, offset, lnum, col) {
        console.log("Starring a line");
        buffer.addAnno(star, offset);
    });
});
server.listen(function () {
    console.log("Server started.");
});


